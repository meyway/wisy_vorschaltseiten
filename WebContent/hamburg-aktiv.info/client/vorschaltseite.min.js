function init_vorschaltseite(){if(!vorschaltseite_an){return false}if(window.location.hash=="#skip_preload"){return false}propagate_dist_url(dist_portal_url+"#favorit");if(window.location.hash=="#favorit"||jQuery.cookie("pref_portal")==document.domain){jQuery("#super_wrapper").remove();pref_set_cookie();return false}else if(is_homepage()&&(document.referrer==""||!document.referrer.match(document.domain))){vorschaltseite_display();return true}return false}function fernes_portal_jetzt_abfragen(){if(!fernes_portal_abfragen){return false}var e=createCORSRequest("GET",callback_url);if(!e){setTimeout(function(){xss_ajax(callback_url+"?format=JSONP")},1);return true}else{e.onload=function(){var t=e.responseText;if(e.status!=200){return false}var n=jQuery.parseJSON(t);if(typeof n!=="object"){log_error("Kein Response-Object: "+t);return false}if(n.pref_portal!=""&&n.pref_portal!="undefined"){callback(n)}else{}}}e.onerror=function(){log_error("Fehler!")};var t=e;setTimeout(function(){t.send()},1);return true}function createCORSRequest(e,t){var n=new XMLHttpRequest;if("withCredentials"in n){n.open(e,t,true);n.withCredentials=true;n.setRequestHeader("Accept","plain/text")}else if(typeof XDomainRequest!="undefined"){}else{n=null}return n}function xss_ajax(e){var t=null;var n=document.createElement("script");n.setAttribute("type","text/javascript");n.setAttribute("src",e);n.setAttribute("id","distportalscript");t=document.getElementById("distportalscript");if(t){document.getElementsByTagName("head")[0].removeChild(t)}document.getElementsByTagName("head")[0].appendChild(n)}function callback(e){if(e.pref_portal==document.domain){vorschaltseite_remove()}else if(e.pref_portal=="undefined"||e.pref_portal==null){}else{vorschaltseite_display();var t=confirm(wechseln_txt1+e.pref_portal.toUpperCase()+wechseln_txt2);if(t==true){window.location.href=dist_portal_url+"#favorit"}else{vorschaltseite_remove();setTimeout(function(){xss_ajax(callback_url+"?reset=pref_portal")},1)}}}function vorschaltseite_display(){jQuery("#super_wrapper").show();jQuery("html,body").css("overflow","hidden");jQuery("#wisy_contentarea").hide()}function vorschaltseite_remove(){jQuery("#super_wrapper").remove();jQuery("body").css({"margin-left":"8px",height:"100%","min-height":"100%"});jQuery("#wisy_contentarea").show();pref_set_cookie()}function pref_set_cookie(){jQuery.cookie("pref_portal",document.domain,{expires:prefcookie_gueltigkeit})}function propagate_dist_url(e){jQuery(".dist-portal a").each(function(){jQuery(this).attr("href",dist_portal_url+"#favorit")})}function preload(e){if(window.location.hash!="#skip_preload"&&!preload_done){var t=jQuery("#dist_portal_preload");if(t.length>0){t.remove()}jQuery("<iframe />",{src:dist_portal_url+"#skip_preload",id:"dist_portal_preload"}).appendTo("#wrapper").hide();preload_done=true}}function is_homepage(){return jQuery("body.wisyp_homepage").length>0&&jQuery("body.ohnebezirksauswahl").length==0}function log_error(e){if(typeof console==="undefined"){}else{console.log(e)}}jQuery(document).ready(function(){if(init_vorschaltseite()){fernes_portal_jetzt_abfragen();if(fernes_portal_vorladen){jQuery(".dist-portal").mouseenter(function(){setTimeout(function(){preload(dist_portal_url+"#skip_preload")},1)})}}else{log_error("Initialisierung des Vorschaltfensters konnte nicht durchgefuehrt werden oder ausgeschaltet.")}});